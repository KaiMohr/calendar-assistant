#!/usr/bin/env bash

set -e

FILENAME=${1:-README.md}

modules="ansi-to-html markdown-toc"

for module in $modules ; do
  if [[ ! -e node_modules/.bin/$module ]] ; then
    echo "NOTICE: installing npm module $module ..."
    npm install $module
  fi
done

echo "Generating content into ${FILENAME} ..."
export THOR_COLUMNS=100
erb README.md.erb > $FILENAME
node_modules/.bin/markdown-toc $FILENAME -i --maxdepth 3
